# JavaScript 数组方法全面总结

## 一、基础创建与访问方法

### 1.1 创建数组
```javascript
// 字面量创建
const arr1 = [1, 2, 3];
const arr2 = new Array(1, 2, 3);

// 创建指定长度的空数组
const emptyArr = new Array(7); // [empty × 7]

// Array.from() - 从类数组或可迭代对象创建
const arrFrom = Array.from({length: 5}, (_, i) => i + 1); // [1, 2, 3, 4, 5]
```

### 1.2 访问元素
```javascript
const arr = [10, 20, 30];

// 传统索引
console.log(arr[0]); // 10

// at() 方法（支持负数索引）
console.log(arr.at(-1)); // 30（最后一个元素）
console.log(arr.at(-2)); // 20（倒数第二个）
```

## 二、修改数组的方法（会改变原数组）

### 2.1 添加/删除元素
```javascript
const arr = [1, 2, 3];

// push - 末尾添加
arr.push(4); // [1, 2, 3, 4]

// pop - 末尾删除
arr.pop(); // [1, 2, 3]

// unshift - 开头添加
arr.unshift(0); // [0, 1, 2, 3]

// shift - 开头删除
arr.shift(); // [1, 2, 3]

// splice - 在指定位置添加/删除
arr.splice(1, 0, 'a', 'b'); // 在索引1处插入'a','b'，[1, 'a', 'b', 2, 3]
arr.splice(2, 2); // 从索引2开始删除2个元素，[1, 'a', 3]
```

### 2.2 填充与反转
```javascript
// fill - 填充数组
const arr = new Array(5).fill(0); // [0, 0, 0, 0, 0]
arr.fill(1, 2, 4); // [0, 0, 1, 1, 0]

// reverse - 反转数组
arr.reverse(); // [0, 1, 1, 0, 0]
```

### 2.3 排序
```javascript
const arr = [3, 1, 4, 1, 5];

// sort - 排序（默认按字符串排序）
arr.sort(); // [1, 1, 3, 4, 5]

// 数字排序
arr.sort((a, b) => a - b); // 升序
arr.sort((a, b) => b - a); // 降序

// 自定义排序
const users = [
  {name: 'John', age: 25},
  {name: 'Jane', age: 30}
];
users.sort((a, b) => a.age - b.age);
```

## 三、非破坏性方法（返回新数组）

### 3.1 切片与连接
```javascript
const arr = [1, 2, 3, 4, 5, 6];

// slice - 切片
arr.slice(2);      // [3, 4, 5, 6]
arr.slice(2, 4);   // [3, 4]
arr.slice(-2);     // [5, 6]
arr.slice(1, -2);  // [2, 3, 4]

// concat - 连接数组
const newArr = arr.concat([7, 8]); // [1, 2, 3, 4, 5, 6, 7, 8]
// 或使用扩展运算符
const newArr2 = [...arr, 7, 8];
```

### 3.2 非破坏性变体（ES2023）
```javascript
const arr = [1, 2, 3, 4, 5];

// toReversed
const reversed = arr.toReversed(); // [5, 4, 3, 2, 1]
console.log(arr); // [1, 2, 3, 4, 5]（原数组不变）

// toSorted
const sorted = arr.toSorted((a, b) => b - a); // [5, 4, 3, 2, 1]

// toSpliced
const spliced = arr.toSpliced(1, 2, 'a', 'b'); // [1, 'a', 'b', 4, 5]

// with - 替换指定位置的元素
const withArr = arr.with(2, 99); // [1, 2, 99, 4, 5]
```

## 四、遍历与转换方法

### 4.1 遍历方法
```javascript
const arr = [10, 20, 30, 40];

// forEach - 遍历
arr.forEach((value, index, array) => {
  console.log(`arr[${index}] = ${value}`);
});

// map - 映射为新数组
const doubled = arr.map(x => x * 2); // [20, 40, 60, 80]

// filter - 过滤
const filtered = arr.filter(x => x > 20); // [30, 40]

// reduce - 累积计算
const sum = arr.reduce((acc, curr) => acc + curr, 0); // 100
const max = arr.reduce((acc, curr) => Math.max(acc, curr), arr[0]); // 40

// reduceRight - 从右向左累积
const reverseStr = ['h', 'e', 'l', 'l', 'o']
  .reduceRight((acc, curr) => acc + curr, ''); // 'olleh'
```

### 4.2 查找方法
```javascript
const arr = [10, 20, 30, 20, 40];

// find - 查找第一个符合条件的元素
const found = arr.find(x => x > 25); // 30

// findLast - 查找最后一个符合条件的元素
const lastFound = arr.findLast(x => x < 25); // 20

// findIndex - 查找索引
const index = arr.findIndex(x => x > 25); // 2

// findLastIndex - 查找最后一个符合条件的索引
const lastIndex = arr.findLastIndex(x => x < 25); // 3

// includes - 是否包含
const has20 = arr.includes(20); // true
```

## 五、扁平化与分组

### 5.1 扁平化
```javascript
const nested = [1, [2, [3, 4]], 5];

// flat - 扁平化
nested.flat();       // [1, 2, [3, 4], 5]
nested.flat(2);      // [1, 2, 3, 4, 5]
nested.flat(Infinity); // 完全扁平化

// flatMap - 映射后扁平化
const arr = [1, 2, 3];
const result = arr.flatMap(x => [x, x * 2]); // [1, 2, 2, 4, 3, 6]
```

### 5.2 分组（ES2023）
```javascript
const transactions = [100, -50, 200, -30, 150];

// Object.groupBy - 按条件分组
const grouped = Object.groupBy(transactions, amount => {
  return amount > 0 ? 'deposit' : 'withdrawal';
});
// { deposit: [100, 200, 150], withdrawal: [-50, -30] }

// Map.groupBy - 返回Map对象
const mapGrouped = Map.groupBy(transactions, amount => 
  amount > 0 ? 'positive' : 'negative'
);
```

## 六、条件判断方法

### 6.1 布尔判断
```javascript
const arr = [10, 20, 30, 40];

// some - 是否有元素满足条件
const hasNegative = arr.some(x => x < 0); // false

// every - 是否所有元素都满足条件
const allPositive = arr.every(x => x > 0); // true

// includes - 是否包含特定值
const has20 = arr.includes(20); // true
```

## 七、实用模式与技巧

### 7.1 链式调用
```javascript
const movements = [200, 450, -400, 3000, -650];

// 常见链式模式
const totalDeposits = movements
  .filter(mov => mov > 0)           // 过滤正数
  .map(mov => mov * 1.1)            // 转换为USD
  .reduce((acc, mov) => acc + mov, 0); // 求和
```

### 7.2 数组去重
```javascript
const arr = [1, 2, 2, 3, 3, 4];

// 方法1: Set
const unique1 = [...new Set(arr)]; // [1, 2, 3, 4]

// 方法2: filter + indexOf
const unique2 = arr.filter((item, index) => 
  arr.indexOf(item) === index
);

// 方法3: reduce
const unique3 = arr.reduce((acc, curr) => 
  acc.includes(curr) ? acc : [...acc, curr], []
);
```

### 7.3 数组转字符串
```javascript
const arr = ['Hello', 'World'];

// join - 连接为字符串
arr.join(' ');      // 'Hello World'
arr.join(' - ');    // 'Hello - World'
arr.toString();     // 'Hello,World'
```

### 7.4 数组解构
```javascript
const arr = [1, 2, 3, 4, 5];

// 基础解构
const [first, second] = arr; // first=1, second=2

// 跳过元素
const [a, , b] = arr; // a=1, b=3

// 剩余元素
const [x, ...rest] = arr; // x=1, rest=[2, 3, 4, 5]

// 默认值
const [y = 0, z = 0] = []; // y=0, z=0
```

## 八、性能与注意事项

### 8.1 方法时间复杂度
- **O(1)**: push, pop
- **O(n)**: shift, unshift, splice, concat
- **O(n log n)**: sort
- **O(n)**: forEach, map, filter, reduce

### 8.2 最佳实践
```javascript
// 1. 避免在循环中修改数组长度
// ❌ 不要这样做
for (let i = 0; i < arr.length; i++) {
  if (arr[i] === target) {
    arr.splice(i, 1);
    i--; // 需要调整索引
  }
}

// ✅ 使用filter
arr = arr.filter(item => item !== target);

// 2. 使用非破坏性方法保持数据不可变性
const original = [1, 2, 3];
const modified = original.map(x => x * 2); // 不改变原数组

// 3. 大型数组使用for循环而不是forEach
// 对于性能敏感的场景
for (let i = 0; i < largeArray.length; i++) {
  // 操作
}
```

## 九、常见用例示例

### 9.1 数据转换
```javascript
// 从对象数组中提取特定属性
const users = [
  {id: 1, name: 'Alice'},
  {id: 2, name: 'Bob'}
];
const names = users.map(user => user.name); // ['Alice', 'Bob']

// 转换为Map
const userMap = new Map(users.map(user => [user.id, user]));
```

### 9.2 数据聚合
```javascript
// 分组统计
const orders = [
  {product: 'A', amount: 100},
  {product: 'B', amount: 200},
  {product: 'A', amount: 150}
];

const totals = orders.reduce((acc, order) => {
  acc[order.product] = (acc[order.product] || 0) + order.amount;
  return acc;
}, {});
// {A: 250, B: 200}
```

### 9.3 分页处理
```javascript
function paginate(array, page, pageSize) {
  const start = (page - 1) * pageSize;
  return array.slice(start, start + pageSize);
}

const items = [1, 2, 3, 4, 5, 6, 7, 8, 9];
paginate(items, 2, 3); // [4, 5, 6]
```

## 总结表：常用数组方法对比

| 方法 | 用途 | 是否改变原数组 | 返回值 |
|------|------|----------------|--------|
| push/pop | 添加/删除末尾元素 | ✅ 是 | 新长度/被删除元素 |
| shift/unshift | 添加/删除开头元素 | ✅ 是 | 新长度/被删除元素 |
| splice | 添加/删除任意位置 | ✅ 是 | 被删除元素数组 |
| slice | 切片 | ❌ 否 | 新数组 |
| concat | 连接数组 | ❌ 否 | 新数组 |
| map | 映射转换 | ❌ 否 | 新数组 |
| filter | 过滤 | ❌ 否 | 新数组 |
| reduce | 累积计算 | ❌ 否 | 单个值 |
| forEach | 遍历 | ❌ 否 | undefined |
| find/findIndex | 查找 | ❌ 否 | 元素/索引 |
| some/every | 条件判断 | ❌ 否 | 布尔值 |
| sort | 排序 | ✅ 是 | 排序后的数组 |
| reverse | 反转 | ✅ 是 | 反转后的数组 |
| flat/flatMap | 扁平化 | ❌ 否 | 新数组 |
| toSorted/toReversed | 非破坏性排序/反转 | ❌ 否 | 新数组 |
| Object.groupBy | 分组 | ❌ 否 | 对象 |

---

这个总结涵盖了 JavaScript 数组的核心方法、使用技巧和最佳实践，适合作为日常开发的参考指南。